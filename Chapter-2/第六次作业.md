##Computational Physics<br/>the sixth homework

罗开发   2014301580293  update:2016.04.12

###Abstract
&nbsp;&nbsp;&nbsp;&nbsp;The motion of the trajectory of our cannon shell including both drag and the reduced air density at high altitude can be described by servel proper ordinary differential eqautions.From this point,we could try to use some ODEs to describe the realistic motion of cannon shell step by step,which means that we don't take the drag and the reduced density at high altitude at first, on the basis of this simplification, we will gradually add them to our model.Through the procedure from simple to complicate, ODEs will be inceased to describe the system more precise.

---------------

###Background
&nbsp;&nbsp;&nbsp;&nbsp;Many realistic projectile motion of objects through the atmosphere are all able to be described by ordinary differential equations in which initial values are given and all can be solved using the Euler method.Thus, we hold the view that some ODEs can be found to describe our problem—— the trajectile of the cannon shell, which is just a simple projectile motion if air's drag isn't considered.And then we use another ODE to take the drag of air into account.But we know the air isn't well-distributed if the cannon shell flies high enough.For the reason of which,we must add ODEs to describe the reduced air density at high altitudes.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Along this idea, we could find serials ODEs to make our physics procedure described well, then Euler method is time to be taken to solve the ordinary differential equation group, which gives us access to do something interesting.


-----------------

###The Text
####1.Exercise 2.9——The flying cannon shell
#####1.1 Problem
1. Calculate the trajectile of cannon shell including air drag;
2. Consider how the air's density vary with altitude and take it into the cannon shell's account;
3. Change the firing angles, perform the calculation and search the value of the angle which gives the maximum range.
<div align=center>![3D加农炮](https://raw.githubusercontent.com/luokaifa-whu/computationalphysics_N2014301580293/master/Chapter-2/3D%E5%8A%A0%E5%86%9C%E7%82%AE.jpg)</div>

#####1.2 Thinking
######1. No air
&nbsp;&nbsp;&nbsp;&nbsp;If we don't consider the air's drag, the cannon shell will make a simple oblique projectile motion, which can be described by ODE easily.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;In the ground reference system，we consider the X direction and Y direction respectively，and the cannon shell is only draged by gravity,which means that:<br/>
<div align=center>![微分方程组](http://latex.codecogs.com/gif.latex?%5Cleft%5C%7B%5Cbegin%7Bmatrix%7D%20%5Cfrac%7B%5Cmathrm%7Bd%7D%20x%7D%7B%5Cmathrm%7Bd%7D%20t%7D%3Dv_x%5C%5C%20%5Cfrac%7B%5Cmathrm%7Bd%7Dv_x%7D%7B%5Cmathrm%7Bd%7D%20t%7D%3D0%5C%5C%20%5Cfrac%7B%5Cmathrm%7Bd%7D%20y%7D%7B%5Cmathrm%7Bd%7D%20t%7D%3Dv_y%5C%5C%20%5Cfrac%7B%5Cmathrm%7Bd%7D%20v_y%7D%7B%5Cmathrm%7Bd%7D%20t%7D%3D0%20%5Cend%7Bmatrix%7D%5Cright.%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%281%29)</div><br/>
Then,we use Euler theory to discrete it:<br/>
<div align=center>![离散化方程组](http://latex.codecogs.com/gif.latex?%5Cleft%5C%7B%5Cbegin%7Bmatrix%7D%20x_%7Bi&plus;1%7D%3Dx_%7Bi%7D&plus;v_%7Bx%2Ci%7D%5CDelta%20t%5C%5C%20v_%7Bx%2Ci&plus;1%7D%3Dv_%7Bx%2Ci%7D%5C%5C%20y_%7Bi&plus;1%7D%3Dy_%7Bi%7D&plus;v_%7By%2Ci%7D%5CDelta%20t%5C%5C%20v_%7By%2Ci&plus;1%7D%3Dv_%7By%2Ci%7D-g%5CDelta%20t%20%5Cend%7Bmatrix%7D%5Cright.%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%282%29)</div><br/>
here Vx and Vy is respectively the velocities in the X and Y directions.And given the initial values of x,y,Vx, and Vy, we can use the equation group to estimate their values at later times, which are surely approximately for we have ignore order ![二次项](http://latex.codecogs.com/gif.latex?%28%5CDelta%20t%29%5E%7B2%7D) and higher terms.
######2. Air density is constant
&nbsp;&nbsp;&nbsp;&nbsp;On the basis of above, we add the drag force which is given by:<br/>
<div align=center>![风阻方程](http://latex.codecogs.com/gif.latex?F_%7Bdrag%7D%3D-B_2v%5E%7B2%7D%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%283%29%5C%5C%20here%7E%7Ev%3D%5Csqrt%7Bv_x%5E2&plus;v_y%5E2%7D%5C%20is%7Ethe%7Espeed%7Eof%7Eshell)</div><br/>
Set the angle bewteen V and groud as sita, we have:<br/>
<div align=center>![风阻分量方程](http://latex.codecogs.com/gif.latex?%5Cleft%5C%7B%5Cbegin%7Bmatrix%7D%20cos%5Ctheta%20%3D%5Cfrac%7Bv_x%7D%7Bv%7D%5C%5C%20F_%7Bdrag%2Cx%7D%3D-B_2vv_x%5C%5C%20sin%5Ctheta%20%3D%5Cfrac%7Bv_y%7D%7Bv%7D%5C%5C%20F_%7Bdrag%2Cy%7D%3D-B_2vv_y%20%5Cend%7Bmatrix%7D%5Cright.%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%284%29)</div><br/>
&nbsp;&nbsp;&nbsp;&nbsp;So,taking air force into acount is equal to add (4) to (2):<br/>
<div align=center>![考虑风阻的运动分量方程](http://latex.codecogs.com/gif.latex?%5Cleft%5C%7B%5Cbegin%7Bmatrix%7D%20x_%7Bi&plus;1%7D%3Dx_%7Bi%7D&plus;v_%7Bx%2Ci%7D%5CDelta%20t%5C%5C%20v_%7Bx%2Ci&plus;1%7D%3Dv_%7Bx%2Ci%7D-%5Cfrac%7BB_2vv_%7Bx%2Ct%7D%7D%7Bm%7D%5CDelta%20t%5C%5C%20y_%7Bi&plus;1%7D%3Dy_%7Bi%7D&plus;v_%7By%2Ci%7D%5CDelta%20t%5C%5C%20v_%7By%2Ci&plus;1%7D%3Dv_%7By%2Ci%7D-g%5CDelta%20t-%5Cfrac%7BB_2vv_%7By%2Ct%7D%7D%7Bm%7D%5CDelta%20t%5Cend%7Bmatrix%7D%5Cright.%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%285%29)</div><br/>
######3. Air density at high altitudes is reduced
&nbsp;&nbsp;&nbsp;&nbsp;As we know,the cannons' range are generally up to tens of kilometers,where air density can't be considered as a constant anymore.<br/>
<div align=center>![大气密度分层图](https://raw.githubusercontent.com/luokaifa-whu/computationalphysics_N2014301580293/master/Chapter-2/%E5%A4%A7%E6%B0%94%E5%AF%86%E5%BA%A6.jpg)</div><br/>
&nbsp;&nbsp;&nbsp;&nbsp;Here we assume that the are is a poor conductor of heat and that convection is very slow, which leads to the adiabatic approximation is:<br/>
<div align=center>![绝热模型](http://latex.codecogs.com/gif.latex?%5Crho%20%3D%5Crho_0%281-%5Cfrac%7Bay%7D%7BT_0%7D%29%5E%5Calpha%20%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%286%29%5C%5C%20here%7Ea%5Capprox%206.5%5Ctimes%2010%5E%7B-3%7DK/m%2C%7E%5Calpha%5Capprox2.5%7Efor%7Eair%2C%7ET_0%7Eis%7Ethe%7Elevel%7Etemperature)</div><br/>
As a matter of fact, the reduced air density leads to the reduced drag force. If we simplify the generation mechanism of air resistance, which is just considered as the consequence of impact of objects and air molecules, we can regard that the air drag is relavant with air density linearly,so:<br/>
<div align=center>![空气阻力随高度变化公式](http://latex.codecogs.com/gif.latex?F%5E*_%7Bdrag%7D%3D%5Cfrac%7B%5Crho%7D%7B%5Crho_0%7DF_%7Bdrag%7D%28y%3D0%29%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%287%29%5C%5C%20here%7EF_%7Bdrag%7D%28y%3D0%29%7Eis%7Ethe%7Eforce%7Eat%7Esea%7Elevel%2C%7Ewhich%7Egiven%7Eby%7E%283%29)</div><br/>
Till here, we get the drag ![高度阻力公式](http://latex.codecogs.com/gif.latex?F%5E*_%7Bdrag%7D)force as a function of altitude. From above,a approximate model to describe the motion of cannon shell through euler theory and a serials of simplicities has been bulit:<br/>
<div align=center>![离散模型](http://latex.codecogs.com/gif.latex?%5Cleft%5C%7B%5Cbegin%7Bmatrix%7Dx_%7Bi&plus;1%7D%3Dx_%7Bi%7D&plus;v_%7Bx%2Ci%7D%5CDelta%20t%5C%5C%20v_%7Bx%2Ci&plus;1%7D%3Dv_%7Bx%2Ci%7D-%5Cfrac%7BB_2vv_%7Bx%2Ct%7D%7D%7Bm%7D%281-%5Cfrac%7Bay%7D%7BT_0%7D%29%5CDelta%20t%5C%5Cy_%7Bi&plus;1%7D%3Dy_%7Bi%7D&plus;v_%7By%2Ci%7D%5CDelta%20t%5C%5C%20v_%7By%2Ci&plus;1%7D%3Dv_%7By%2Ci%7D-g%5CDelta%20t-%5Cfrac%7BB_2vv_%7By%2Ct%7D%7D%7Bm%7D%281-%5Cfrac%7Bay%7D%7BT_0%7D%29%5CDelta%20t%5Cend%7Bmatrix%7D%5Cright.%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%288%29)</div><br/>
######4. The exact solution
&nbsp;&nbsp;&nbsp;&nbsp;If the equation group (1) isn't discreted and we will get a ODE group to discribe our cannon shell's motion more precise, which is:<br/>
<div align=center>![ODEs](http://latex.codecogs.com/gif.latex?%5Cleft%5C%7B%5Cbegin%7Bmatrix%7D%5Cfrac%7B%5Cmathrm%7Bd%5E2%7Dv_x%20%7D%7B%5Cmathrm%7Bd%7D%20t%5E2%7D%3D-%5Cfrac%7BB_2vv_%7Bx%7D%7D%7Bm%7D%281-%5Cfrac%7Bay%7D%7BT_0%7D%29%5C%5C%20%5Cfrac%7B%5Cmathrm%7Bd%5E2%7Dv_y%20%7D%7B%5Cmathrm%7Bd%7D%20t%5E2%7D%3D-g-%5Cfrac%7BB_2vv_%7By%2Ct%7D%7D%7Bm%7D%281-%5Cfrac%7Bay%7D%7BT_0%7D%29%5Cend%7Bmatrix%7D%5Cright.%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%7E%289%29%5C%5C%20here%7Em%7Eis%7Ethe%7Emass%7Eof%7Ecannon%7Eshell.)</div><br/>
Whose  analytic solution is hard to find.<br/>


#####1.3 [Click this to see the Source Codes]()

#####1.4 Drawings of the numerical simlation

#####1.5 A small summary section

